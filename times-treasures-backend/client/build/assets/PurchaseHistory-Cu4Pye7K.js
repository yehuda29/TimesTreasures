import{r as i,A as g,j as e,a as m,y as x}from"./index-TEer4uYd.js";import{g as y}from"./imageUtil-CPgIs8eT.js";const _="_purchaseHistoryContainer_8pr9v_4",f="_refreshBtn_8pr9v_22",j="_purchaseList_8pr9v_40",w="_purchaseItem_8pr9v_47",v="_watchImage_8pr9v_59",H="_purchaseDetails_8pr9v_69",P="_loginMessage_8pr9v_86",t={purchaseHistoryContainer:_,refreshBtn:f,purchaseList:j,purchaseItem:w,watchImage:v,purchaseDetails:H,loginMessage:P},L=()=>{const{user:n,token:h}=i.useContext(g),[l,u]=i.useState([]),[p,o]=i.useState(!0);return i.useEffect(()=>{n?(async()=>{var a,r;try{const c={headers:{Authorization:`Bearer ${h}`}},d=await m.get("http://localhost:5000/api/users/purchase-history",c);u(d.data.data),o(!1)}catch(c){console.error("Error fetching purchase history:",c),x.error(((r=(a=c.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to fetch purchase history"),o(!1)}})():o(!1)},[h,n]),p?e.jsx("div",{children:"Loading..."}):n?e.jsxs("div",{className:t.purchaseHistoryContainer,children:[e.jsx("h2",{children:"Your Purchase History"}),l.length===0?e.jsx("p",{children:"You have no purchases yet."}):e.jsx("ul",{className:t.purchaseList,children:l.map(s=>{var a,r;return e.jsxs("li",{className:t.purchaseItem,children:[e.jsx("img",{src:s.watch&&s.watch.image?y(s.watch.image):"",alt:((a=s.watch)==null?void 0:a.name)||"Deleted Watch",className:t.watchImage}),e.jsxs("div",{className:t.purchaseDetails,children:[e.jsx("h3",{children:((r=s.watch)==null?void 0:r.name)||"Unknown Watch"}),e.jsxs("p",{children:["Quantity: ",s.quantity]}),e.jsxs("p",{children:["Total Price: $",s.totalPrice!==void 0?Number(s.totalPrice).toFixed(2):"0.00"]}),e.jsxs("p",{children:["Purchased on:"," ",s.purchaseDate?new Date(s.purchaseDate).toLocaleDateString():"Unknown Date"]})]})]},s._id)})})]}):e.jsxs("div",{className:t.purchaseHistoryContainer,children:[e.jsx("h2",{children:"Your Purchase History"}),e.jsxs("p",{className:t.loginMessage,children:["Please ",e.jsx("a",{href:"/login",children:"log in"})," in order to see this page."]})]})};export{L as default};
